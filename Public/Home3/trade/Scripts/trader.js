function is_old_ie(){return!0}function request_page(e){window.location=e}function reload_page(){location.reload()}function show_message(e){alert(e)}function show_hide_obj(e){"visible"==e.style.visibility?e.style.visibility="hidden":e.style.visibility="visible"}function check_miner_name(e){return!(e.length>15)&&(reg=new RegExp("^[a-zA-Z0-9__]+$"),!!reg.test(e))}function is_email(e){return/^(?:[a-z\d]+[_\-\+\.]?)*[a-z\d]+@(?:([a-z\d]+\-?)*[a-z\d]+\.)+([a-z]{2,})+$/i.test(e)}function check_username(e){return!!/^[a-zA-Z0-9\_@.]+$/.test(e)}function GetBrowserType(){return navigator.userAgent.indexOf("MSIE")>0?"MSIE":(isFirefox=navigator.userAgent.indexOf("Firefox")>0)?"Firefox":(isSafari=navigator.userAgent.indexOf("Safari")>0)?"Safari":(isCamino=navigator.userAgent.indexOf("Camino")>0)?"Camino":(isMozilla=navigator.userAgent.indexOf("Gecko/")>0)?"Gecko":"Unknow"}function get_element(e,t){return null==t&&(t=0),obj=document.getElementById(e),obj||(obj=document.getElementsByName(e),obj?obj[t]:null)}function search_child(e,t){if(!e||!e.hasChildNodes())return!1;if(t)for(var n=0;n<e.childNodes.length;n++){if(e.childNodes[n].id==t||e.childNodes[n].name==t)return e.childNodes[n];if(result=search_child(e.childNodes[n],t),result)return result}return!1}function check_number(e){var t=e.keyCode;return!(!e.ctrlKey&&!e.altKey)||(t>=48&&t<=57||t>=96&&t<=105||8==t||46==t||27==t||37==t||39==t||16==t||9==t||33==t||34==t||190==t||t>=91&&t<=93||t>=110&&t<124)}function get_max(e,t){return e>t?e:t}function get_min(e,t){return e<t?e:t}function cut_float_zero(e){var t=e.indexOf(".");if(t<0)return e;for(var n=e.length,r=e.length-1;r>=t&&("0"==e[r]||"."==e[r]);r--)n=r;return e.substr(0,n)}function num_need_fix(e,t){var n=(e=e.toString()).indexOf(".");return!(n<0)&&(e.length-n-1>t&&(t>0?e.substr(0,n+t+1):e.substr(0,n)))}function num_fix(e,t){var n=num_need_fix(e=Number(e).toFixed(15),t);return n||e}function rand(e,t){return Math.floor(Math.random()*t+e)}function page_rand(){return"&c="+rand(0,1e6)}function get_view_symbol(e,t){return null==t||"l"==t?e.substr(0,3).toUpperCase():e.substr(4).toUpperCase()}function get_symbols(e){var t=e.indexOf("_");return t>=0?[e.substr(0,t).toUpperCase(),e.substr(t+1,e.length-t-1).toUpperCase()]:[""]}function trim(e){for(var t=0;t<e.length&&" "==e.charAt(t);t++);for(var n=e.length;n>0&&" "==e.charAt(n-1);n--);return t>n?"":e.substring(t,n)}function fireEvent(e,t){if(document.createEventObject){var n=document.createEventObject();return e.fireEvent("on"+t,n)}return(n=document.createEvent("HTMLEvents")).initEvent(t,!0,!0),!e.dispatchEvent(n)}function get_query_string(e){if(-1==location.href.indexOf("?")||-1==location.href.indexOf(e+"="))return"";for(var t,n,r,a=location.href.substring(location.href.indexOf("?")+1).split("<!@!>"),i=0;i<a.length;i++)if(-1!=(t=a[i].indexOf("="))&&(n=a[i].substring(0,t),r=a[i].substring(t+1),n==e))return unescape(r.replace(/\+/g," "));return""}function updateOrderTab(e,t){var n=$("#ulMyOrderList").find("li").size(),r=$("#my-trade-list").find("li").size();1==t?2!=e?n<1?(0==$("#order-info-box").find(".noorder-tip").size()&&$("#order-info-box").append("<div class=noorder-tip><i class='order-tip-icon'>i</i><i>暂无委托</i></div>"),$("#currOrder,#historyOrder").css("height","110px"),$("#ulMyOrderList,#my-trade-list").css("height","70px"),"0"===$.cookie("show_kline")?$("#my-fund-list").css("height","629px"):$("#my-fund-list").css("height","349px")):($("#order-info-box").find(".noorder-tip").remove(),"0"===$.cookie("show_kline")?($("#ulMyOrderList,#my-trade-list").css("height","340px"),$("#currOrder,#historyOrder,#my-fund-list").css("height","380px")):($("#currOrder,#historyOrder").css("height","250px"),$("#ulMyOrderList,#my-trade-list").css("height","209px"),$("#my-fund-list").css("height","209px"))):r<1?(0==$("#history-info-box").find(".noorder-tip").size()&&$("#history-info-box").append("<div class=noorder-tip><i class='order-tip-icon'>i</i><i>暂无委托</i></div>"),$("#currOrder,#historyOrder").css("height","110px"),$("#ulMyOrderList,#my-trade-list").css("height","70px"),"0"===$.cookie("show_kline")?$("#my-fund-list").css("height","629px"):$("#my-fund-list").css("height","349px")):($("#history-info-box").find(".noorder-tip").remove(),"0"===$.cookie("show_kline")?($("#ulMyOrderList,#my-trade-list").css("height","340px"),$("#currOrder,#historyOrder,#my-fund-list").css("height","380px")):($("#currOrder,#historyOrder").css("height","250px"),$("#ulMyOrderList,#my-trade-list").css("height","209px"),$("#my-fund-list").css("height","209px"))):(0==$("#order-info-box").find(".index-modal").size()&&$("#order-info-box").append("<div class='index-modal'><i class='order-tip-icon'>i</i><i>暂无委托</i><a class='sub-btn' href='/login'>登录后查看</a></div>"),0==$("#history-info-box").find(".index-modal").size()&&$("#history-info-box").append("<div class='index-modal'><i class='order-tip-icon'>i</i><i>暂无委托</i><a class='sub-btn' href='/login'>登录后查看</a></div>"),0==$("#fund-info-box").find(".index-modal").size()&&$("#fund-info-box").append("<div class='index-modal'><i class='order-tip-icon'>i</i><i>暂无资金</i><a class='sub-btn' href='/login'>登录后查看</a></div>"))}function largeOrders(){$("#tableAskList").css("height","680px"),"0"===$.cookie("show_kline")?$("#ul-trade-list").css("height","540px"):$("#ul-trade-list").css("height","270px"),$("#ask-list, #bid-list").css("height","268px"),$("#moreOrders").addClass("more-order-active")}function smallOrders(){$("#tableAskList,#ask-list, #bid-list").css("height",""),"0"===$.cookie("show_kline")?$("#ul-trade-list").css("height","810px"):$("#ul-trade-list").css("height","510px"),$("#ask-list").scrollTop(1050),$("#moreOrders").removeClass("more-order-active")}function sell_all(){var e,t,n="undefined"!=typeof global_precision_vol?global_precision_vol:6,r="undefined"!=typeof global_precision_total?global_precision_total:6;(t=parseFloat(get_element("balance_bid_able").innerHTML))>0&&(e=parseFloat(get_element("bid_rate").value))>0&&(get_element("bid_vol").value=num_fix(t,n),get_element("bid_amount").value=num_fix(e*t,r))}function buy_all(){"undefined"!=typeof global_precision_vol&&global_precision_vol;var e,t,n="undefined"!=typeof global_precision_total?global_precision_total:6;(t=parseFloat(get_element("balance_ask_able").innerHTML))>0&&(e=parseFloat(get_element("ask_rate").value))>0&&(get_element("ask_amount").value=num_fix(t,n),get_element("ask_vol").value=num_fix(t/e,n))}function set_price(e,t,n,r){var a=parseFloat(get_element("balance_bid_able").innerHTML),i=parseFloat(get_element("balance_ask_able").innerHTML),o="undefined"!=typeof global_precision_vol?global_precision_vol:6,l="undefined"!=typeof global_precision_total?global_precision_total:6;-1!=(t=parseFloat(t)).toString().indexOf("e")&&(t=t.toFixed(8)),get_element("ask_rate").value=t,get_element("bid_rate").value=t,e?r-i>1e-8&&(r=i,n=i/t):n-a>1e-8&&(n=a,r=a*t);var s=parseFloat(Number(r).toFixed(8));-1!=s.toString().indexOf("e")&&(s=s.toFixed(8)),e?(get_element("ask_vol").value=num_fix(n,o),get_element("ask_amount").value=num_fix(s,l)):(get_element("bid_vol").value=num_fix(n,o),get_element("bid_amount").value=num_fix(s,l))}function trade_operator(e,n,r,a,o,l,s,d,_){a=void 0!==a?a:0,fee_percentage_buy=void 0!==a?a:0,d=void 0!==d?d:a,o=void 0!==o?o:6,l=void 0!==l?l:6,s=void 0!==s?s:6,_=void 0!==_?_:4086;is_old_ie()?(window.tradeInfoBox=null,window.dealInfoBox=null):(window.Widget=JUtils.Widget,window.tradeInfoBox=new TradeInfoBox(Widget),window.dealInfoBox=new DealInfoBox(Widget));var u={last_group_sec:1800,last_range_hour:1,is_line:0,recheck_main_rates:function(){u.reload_main_rates()},get_tline:function(e,t){var n,r,a,i=u.last_group_sec;u.last_range_hour;if(!t||t.length<=0)return!1;n=[],t.sort(function(e,t){return parseFloat(e[7])-parseFloat(t[7])});var o,l,s,d,_,c,m,f,b,h,g,p=(e-288e5)/1e3,y=0,v=0;for(a=t.length,r=0;r<a;r++)o=t[r],parseInt(o[7]),s=parseFloat(o[2]),d=parseFloat(o[3]),l=parseInt(o[5]),_=1e3*((_=Math.floor(l/i)*i)+28800),0!=v?(Math.abs(l-y)>=i&&(v=2),1==v&&(g+=d,f=s,s>b&&(b=s),s<h&&(h=s)),2==v&&(c=[_,g,m,b,h,f],n.push(c),m=s,f=s,b=s,h=s,g=d,_=1e3*((_=Math.ceil(l/i)*i)+28800),y=Math.floor(l/i)*i,v=1)):(y=p,m=s,f=s,b=s,h=s,g=d,v=1);return 1==v&&(c=[_=1e3*((_=Math.ceil(l/i)*i)+28800),g,m,b,h,f],n.push(c)),n},update_main_rates:function(e){if(!e)return!1;var t;u.last_group_sec,u.last_range_hour;var n=trade_global.main_chart.series[2],r=trade_global.main_chart.series[1],a=trade_global.main_chart.series[0];if(!n||!r||!a)return!1;if(r.length<=0)return!1;var i=0;if(r.points.length>0&&(i=r.points[r.points.length-1].x),(t=u.get_tline(i,e.history))&&!(t.length<=0)){var o,l,s=[],d=[],_=[];for(o=0;o<t.length;o++)d.push([t[o][0],t[o][5],t[o][3],t[o][4],t[o][2]]),s.push([t[o][0],t[o][5]]),_.push([t[o][0],t[o][1]]);var c,m;for(n.setVisible(!0),o=0;o<s.length;o++)if(!((c=s[o])[0]<n.points[0].x))if(c[0]>n.points[n.points.length-1].x)n.addPoint(c,!0,!0);else for(l=0;l<n.points.length;l++)if((m=n.points[l]).x==c[0]){m.y=c[1];break}for(n.setVisible(u.is_line),n.redraw(),o=0;o<_.length;o++)if(!((c=_[o])[0]<a.points[0].x))if(c[0]>a.points[a.points.length-1].x)a.addPoint(c,!0,!0);else for(l=0;l<a.points.length;l++)if((m=a.points[l]).x==c[0]){m.y+=c[1];break}for(a.redraw(),r.setVisible(!0),o=0;o<d.length;o++)if(!((c=d[o])[0]<r.points[0].x))if(c[0]>r.points[r.points.length-1].x)r.addPoint(c,!0,!0);else for(l=0;l<r.points.length;l++)if(m=r.points[l],c[0]==m.x){m.high<c[2]&&(m.high=c[2]),m.low>c[3]&&(m.low=c[3]),m.close=c[4],m.y=m.high;break}r.setVisible(!u.is_line),r.redraw(),trade_global.main_chart.redraw()}},line_toggle:function(e){"k"==e?(u.is_line=0,trade_global.main_chart.series[2].setVisible(!0),trade_global.main_chart.series[3].setVisible(!1)):(u.is_line=1,trade_global.main_chart.series[2].setVisible(!1),trade_global.main_chart.series[3].setVisible(!0))},reload_main_rates:function(e,r,a){e=void 0!==e?e:u.last_group_sec,r=void 0!==r?r:u.last_range_hour,a=void 0!==a&&a,u.last_group_sec=e,u.last_range_hour=2*e/3600;var i={symbol:n,group_sec:e,range_hour:r,type:"tline"};$.ajax({type:"get",url:"/json_svr/query/?u=10"+page_rand(),data:i,xhrFields:{withCredentials:!0},success:function(e,n){var r=e;if(r&&r.result&&r.tline){if(a)trade_global.time_line=r.tline;else for(var i=0;i<r.tline.length;i++){var o=r.tline[i];o[0]==trade_global.time_line[trade_global.time_line.length-1][0]?trade_global.time_line[trade_global.time_line.length-1]=o:o[0]>trade_global.time_line[trade_global.time_line.length-1][0]&&trade_global.time_line.push(o)}var l,s,d,_=trade_global.time_line,u=[],c=[],m=[],f=[],b=[],h=[],g=[],p=[],y=[],v=[],x=!1;for(i=0;i<_.length;i++)if(!(_.length>30&&i<20)){for(_[i][2]<1e-6?u.push([_[i][0],1.0001*_[i][5],1.0001*_[i][3],1.0001*_[i][4],1.0001*_[i][2]]):u.push([_[i][0],_[i][5],_[i][3],_[i][4],_[i][2]]),f.push([_[i][0],_[i][5]]),c.push([_[i][0],_[i][1]]),m.push([_[i][0],1*parseFloat(_[i][1]*_[i][5]).toFixed(4)]),l=0,d=0,s=0;s<10;s++)i>=s&&(l+=parseFloat(_[i-s][3]),l+=parseFloat(_[i-s][4]),d+=2);for(d>0?l/=d:l=_[i][3],b.push([_[i][0],l]),md=0,d=0,s=0;s<10;s++)i>=s&&(md+=(parseFloat(_[i-s][3])-l)*(parseFloat(_[i-s][3])-l),md+=(parseFloat(_[i-s][4])-l)*(parseFloat(_[i-s][4])-l),d+=2);for(md=d>0?Math.sqrt(md/d):0,up=l+2*md,dn=l-2*md,g.push([_[i][0],up,dn]),l=0,d=0,s=0;s<21;s++)i>=s&&(l+=parseFloat(_[i-s][3]),l+=parseFloat(_[i-s][4]),d+=2);d>0?l/=d:l=_[i][3],h.push([_[i][0],l]),p.push([_[i][0],b[b.length-1][1]-h[h.length-1][1]]),t=p[p.length-1][1],x||(x=t),x=.2*t+.8*x,y.push([_[i][0],x]),v.push([_[i][0],t-x])}trade_global.main_chart.series[7].setData(v,!0),trade_global.main_chart.series[6].setData(g,!0),trade_global.main_chart.series[5].setData(h,!0),trade_global.main_chart.series[4].setData(b,!0),trade_global.main_chart.series[3].setData(f,!0),trade_global.main_chart.series[2].setData(u,!0),trade_global.main_chart.series[1].setData(m,!0),trade_global.main_chart.series[0].setData(c,!0),trade_global.main_chart.redraw(),a&&trade_global.main_chart.zoomOut()}r=null}})},recheck:function(){u.recheck_main_rates(n)}},c={ask_list:[],bid_list:[],best_ask_rate:0,best_bid_rate:0,init:function(e,t){this.best_ask_rate=t,this.best_bid_rate=e,f.update_best_rate_and_input()},recalc_best_rate:function(){f.update_best_rate()},reload_ask_bid_grid:function(){jQuery("#tableAskList").clearGridData(),jQuery("#tableBidList").clearGridData();for(e=0;e<this.ask_list.length;e++)jQuery("#tableAskList").jqGrid("addRowData",e+1,this.ask_list[e]);jQuery("#tableAskList").setGridParam({sortname:"rate",sortorder:"asc"}).trigger("reloadGrid");for(var e=0;e<this.bid_list.length;e++)jQuery("#tableBidList").jqGrid("addRowData",e+1,this.bid_list[e]);jQuery("#tableBidList").setGridParam({sortname:"rate",sortorder:"desc"}).trigger("reloadGrid")},reload_ask_bid_list_table:function(){var e={type:"ask_bid_list_table",symbol:n};return $.ajax({type:"get",url:"/json_svr/query/?u=11"+page_rand(),data:e,xhrFields:{withCredentials:!0},success:function(e,t){var n=e;if(n&&n.result){if(c.best_ask_rate=n.bid_rate0,c.best_bid_rate=n.ask_rate0,"FTP_BTC"!=trade_global.symbol&&"ftp_btc"!=trade_global.symbol){n.bid_rate0=n.bid_rate0>0?n.bid_rate0:n.ask_rate0?n.ask_rate0:0,n.ask_rate0=n.ask_rate0>0?n.ask_rate0:n.bid_rate0?n.bid_rate0:0;var r=(n.bid_rate0+n.ask_rate0)/2,a=r*_,i=2;i=a>1?2:a>.1?3:a>.01?4:a>.001?5:6;var o=$("#ul-bid-list li").eq(0).find(".price").html();if(void 0!==o){var l=o.length-1-o.indexOf("."),s=+parseFloat(get_element("top_last_rate").innerHTML).toFixed(l);if(r=+parseFloat(r).toFixed(l),$.isNumeric(r)&&r>0&&s!=r){var d=$(".coin-selected span").eq(2).html();if(+parseFloat(d?d.substr(0,d.indexOf("<")-1):"-1")==r){var u=$(".coin-selected font").eq(0).html();if(u.indexOf("+")>-1&&u.indexOf("-")>-1)var m=u.replace(/-/,""),b=+m.substr(1,m.length-2);else{b=+u.substr(1,u.length-2);u.indexOf("-")>-1&&(b=-b)}v=b}else{var h="",g=get_element("top_last_rate_change").getElementsByTagName("font")[0].innerHTML;if(g.indexOf("+")>-1&&g.indexOf("-")>-1){var p=g.replace(/-/,"");h=+p.substr(1,p.length-2)}else h=+g.substr(1,g.length-2),g.indexOf("-")>-1&&(h=-h);var y=parseFloat((100*s/(100+h)).toFixed(l)),v=(r-y)/y*100}isNaN(v)||(trade_global.symbol.toLowerCase().indexOf("_btc")>-1?get_element("top_last_rate_change").innerHTML='<dl class="price-dl"><dd><i id="currPrice">'+r.toFixed(l)+'</i><em>BTC</em><small> 或 </small><i id="currCNY">'+a.toFixed(i)+"</i><em>CNY</em></dd></dl><dl><dd><em><font color="+(v>=0?"#f7471b":"#08a287")+">"+(v>=0?"+":"")+v.toFixed(2)+'%</font></em></dd></dl><div style="clear:both"></div>':get_element("top_last_rate_change").innerHTML="<i id=currPrice>"+r.toFixed(l)+"</i><em><font color="+(v>=0?"#f7471b":"#08a287")+">"+(v>=0?"+":"")+v.toFixed(2)+'%</font></em><span class=arr-con><i class="caret" id="upArrow"></i><i class="caret" id="dnArrow"></i></span>',r>s?(get_element("top_last_rate_change").className="xiaoguoup",$("#upArrow").stop().animate({bottom:"10px"},2e3,function(){$(this).attr("style","")}).show(),$("#currPrice").stop().animate({color:"#ff5e23"},1500,function(){$(this).attr("style","")})):r<s&&(get_element("top_last_rate_change").className="xiaoguodown",$("#dnArrow").stop().animate({top:"25px"},2e3,function(){$(this).attr("style","")}).show(),$("#currPrice").stop().animate({color:"#008069"},1500,function(){$(this).attr("style","")})),get_element("top_last_rate").innerHTML=r.toFixed(l))}}}get_element("ul-ask-list").innerHTML=n.ask_list_table,get_element("ul-bid-list").innerHTML=n.bid_list_table,get_element("ul-trade-list").innerHTML=n.trade_list_table,get_Price_Percent(n.market_rates)}f.update_best_rate(),n=null}}),!0},reload_ask_bid_list:function(){var e={type:"ask_bid_list",symbol:n,tid:dealInfoBox.latestTid};return $.ajax({type:"get",url:"/json_svr/query/?u=12"+page_rand(),data:e,xhrFields:{withCredentials:!0},success:function(e,t){var n=e;n&&n.result&&(c.best_ask_rate=n.bid_rate0,c.best_bid_rate=n.ask_rate0,tradeInfoBox.update(n.orders),dealInfoBox.update(n.history),u.update_main_rates(n.history)),f.update_best_rate(),n=null}}),!0},recheck_ask_bid_list:function(){is_old_ie()?c.reload_ask_bid_list_table():c.reload_ask_bid_list()},recheck:function(){c.recheck_ask_bid_list()}},m={reload_thistory_data_list:function(){var e={type:"trade_history_list",symbol:n};$.ajax({type:"get",url:"/json_svr/query/?u=01"+page_rand(),data:e,xhrFields:{withCredentials:!0},success:function(e,t){var n=e;n&&n.result&&n.history&&dealInfoBox.update(n),n=null}})},recheck_thistory_data:function(){m.reload_thistory_data_list()},recheck:function(){m.recheck_thistory_data()}},f={fee:.01*a,fee_sell:.01*d,my_orders_num:-1,cancelled_orders:[],my_orders:[],on_request_loan:function(e,t,a,i,o,l){if(!r||r<0)noty({text:"请您先登录再进行操作",type:"warning",layout:"bottomLeft",theme:"bterNotyTheme",timeout:5e3});else if("borrow"==e&&parseFloat(t)>parseFloat(i))noty({text:"目前最大额度："+i,type:"warning",layout:"bottomLeft",theme:"bterNotyTheme",timeout:1e4});else if(parseFloat(a)>1||parseFloat(a)<.01)noty({text:"费率范围为大于等于0.01%且小于等于1%",type:"warning",layout:"bottomLeft",theme:"bterNotyTheme",timeout:1e4});else{var s="";if("borrow"==e){var d=get_element("balance_borrow_able").innerHTML;if(t>Number(d))return void noty({text:"超出可借入量，请检查后重新输入",type:"warning",layout:"bottomLeft",theme:"bterNotyTheme",timeout:1e4});s+="请确认借入订单:",s+="<hr/><br>",s+="<table id='tablePending'>",s+="<tr><td>借入数量: </td><td>"+t+"&nbsp;"+n+"</td></tr>",s+="<tr><td>日费率: </td><td>"+a+"%&nbsp;"+n+"</td></tr>",s+="</table>",s+="<br/>"}else{if("lend"!=e)return void noty({text:"无效交易类型",type:"error",layout:"bottomLeft",theme:"bterNotyTheme",timeout:1e4});void 0!==l&&parseInt(l);s+="请确认借出订单:",s+="<hr/><br>",s+="<table id='tablePending'>",s+="<tr><td>借出数量: </td><td>"+t+"&nbsp;"+n+"</td></tr>",s+="<tr><td>日费率: </td><td>"+a+"%</td></tr>",s+=0==o?"<tr><td>期限天数:</td><td>15天</td></tr>":"<tr><td>期限天数:</td><td>15天期限过后自动续期</td></tr>",s+="</table>",s+="<br/>"}noty({text:s,type:"confirm",layout:"bottomLeft",theme:"bterNotyTheme",modal:!0,animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100},buttons:[{addClass:"btn btn-primary",text:"确定下单",onClick:function(n){f.on_request_loan_confirmed(e,t,a,o,l),n.close()}},{addClass:"btn btn-danger",text:"取消",onClick:function(e){e.close()}}]})}},on_request_loan_confirmed:function(e,r,a,i,o){var l={type:e,symbol:n,amount:r,rate:a,auto_renew:i,rask:o};$.ajax({type:"get",url:"/json_svr/loan/?u=1"+page_rand(),data:l,xhrFields:{withCredentials:!0},success:function(r,a){var i=r,o="";if(i.records&&(o+="已成交:",o+="<hr/>",o+="<br/>"),i.pending){o+="已挂单:",o+="<hr/>",o+="<table id='tablePending'>";for(var l=0;l<i.pending.length;l++)o+="<tr><td colspan='2'>单号: </td><td>"+i.pending[l].id+"</td></tr>","borrow"==e?o+="<tr><td>挂单量: </td><td>"+i.pending[l].amount+"&nbsp;"+n+"</td></tr>":"lend"==e&&(o+="<tr><td>挂单量: </td><td>"+i.pending[l].amount+"&nbsp;"+n+"</td></tr>"),o+="<tr><td>日费率: </td><td>"+i.pending[l].rate+"%</td></tr>";"borrow"==e?(t="<font color=green>借入</font>",get_element("balance_borrow_able").innerHTML=get_element("balance_borrow_able").innerHTML-i.pending[0].amount):"lend"==e&&(1==i.pending[0].auto_renew?o+="<tr><td>期限天数: </td><td>自动续期</td></tr>":o+="<tr><td>期限天数: </td><td>15天</td></tr>"),o+="</table>",o+="<br/>"}i.result?noty({text:o,type:"success",layout:"bottomLeft",theme:"bterNotyTheme",timeout:5e3,callback:{onClose:function(){reload_page()}}}):(o="处理失败，请稍候再试！原因是："+i.msg,noty({text:o,type:"error",layout:"bottomLeft",theme:"bterNotyTheme",timeout:1e4,callback:{onShow:function(){}}})),i=null},error:function(e,t,n){noty({text:"网络错误: "+e.status+" "+e.readyState+" "+t+" "+n,type:"error",layout:"bottomLeft",theme:"bterNotyTheme",timeout:1e4,callback:{onShow:function(){}}})}})},cancel_loan_order:function(e,t,n){var r={type:"cancel",symbol:e,loan_type:t,oid:n};$.ajax({type:"get",url:"/json_svr/loan/?u=1"+page_rand(),data:r,xhrFields:{withCredentials:!0},success:function(e,t){var n=e;n&&n.result?(view_code="<div class='cancel_content'>撤单成功!</div>",noty({text:view_code,type:"success",layout:"bottomLeft",theme:"bterNotyTheme",timeout:5e3,callback:{onShow:function(){f.my_orders_num=-1}}})):(view_code="<div class='cancel_content'>撤单失败! "+n.msg+"</div>",noty({text:view_code,type:"warning",layout:"bottomLeft",theme:"bterNotyTheme",timeout:1e4,callback:{onShow:function(){f.my_orders_num=-1}}})),n=null},error:function(){noty({text:"网络错误！",type:"error",layout:"bottomLeft",theme:"bterNotyTheme",timeout:1e4,callback:{onShow:function(){f.my_orders_num=-1}}})}})},on_request_ask_bid:function(e,t,a){var i={open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100};if(!r||r<0)noty({text:"请您先登录再进行操作",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:i,timeout:5e3});else if(a<=0)noty({text:"请输入交易量",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:i,timeout:5e3});else if(t>=1e9||0==t)noty({text:"交易价必须大于0且小于10亿",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:i,timeout:5e3});else if(a>=1e9)noty({text:"单笔交易量必须小于10亿",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:i,timeout:5e3});else{if("ask"==e){var s=get_element("balance_ask_able").innerHTML;if(t*a>Number(s))return void noty({text:"超出可买入额，请检查后重新输入",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:i,timeout:5e3})}else{if("bid"!=e)return void noty({text:"无效交易类型",type:"error",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:i,timeout:5e3});var d=get_element("balance_bid_able").innerHTML;if(a>Number(d))return void noty({text:"超出可卖出额，请检查后重新输入",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:i,timeout:5e3})}var _="",u=.5*(c.best_bid_rate+c.best_ask_rate);"ask"==e?(_+="请确认买入订单:",_+="<hr/><br>",_+="<table id='tablePending'>",_+="<tr><td>买入价格: </td><td>"+num_fix(t,o)+"</td></tr>",_+="<tr><td>买入数量: </td><td>"+num_fix(a,l)+"&nbsp;"+get_view_symbol(n,"l")+"</td></tr>",oper=u>0?(t-u)/u*100:0,oper>20&&(_+="<tr><td><font color=red>警告: <font> </td><td>您的<font color=red>买入</font>价格<font color=red>高于</font>市场平均价格 <font color=red>"+num_fix(oper,1)+"%</font>，请务必检查确认。</td></tr>")):"bid"==e&&(_+="请确认卖出订单:",_+="<hr/><br>",_+="<table id='tablePending'>",_+="<tr><td>卖出价格: </td><td>"+num_fix(t,o)+"</td></tr>",_+="<tr><td>卖出数量: </td><td>"+num_fix(a,l)+"&nbsp;"+get_view_symbol(n,"l")+"</td></tr>",oper=u>0?(u-t)/u*100:0,oper>20&&(_+="<tr><td><font color=red>警告: <font> </td><td>您的<font color=red>卖出</font>价格<font color=red>低于</font>市场平均价格 <font color=red>"+num_fix(oper,1)+"%</font>，请务必检查确认。</td></tr>")),_+="</table>",_+="<br/>",noty({text:_,type:"confirm",layout:"center",theme:"bterNotyTheme",modal:!0,animation:i,buttons:[{addClass:"btn btn-primary",text:"确定下单",onClick:function(n){f.on_request_ask_bid_confirmed(e,t,a),n.close()}},{addClass:"btn btn-danger",text:"取消",onClick:function(e){e.close()}}]})}},on_request_ask_bid_confirmed:function(e,a,i,s,d){s=void 0!==s?s:"",d=void 0!==d?d:"";var _={open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100};if(!r||r<0)noty({text:"请您先登录再进行操作",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:_,timeout:5e3});else if(i<=0)noty({text:"请输入交易量",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:_,timeout:5e3});else if(a>=1e9||0==a)noty({text:"交易价必须大于0且小于10亿",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:_,timeout:5e3});else if(i>=1e9)noty({text:"单笔交易量必须小于10亿",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:_,timeout:5e3});else{if("ask"==e){var u=get_element("balance_ask_able").innerHTML;if(a*i>Number(u))return void noty({text:"超出可买入额，请检查后重新输入",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:_,timeout:5e3})}else{if("bid"!=e)return void noty({text:"无效交易类型",type:"error",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:_,timeout:5e3});var c=get_element("balance_bid_able").innerHTML;if(i>Number(c))return void noty({text:"超出可卖出额，请检查后重新输入",type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:_,timeout:5e3})}var m={type:e,symbol:n,rate:a,vol:i,fundpass:s,captcha:d};$.ajax({type:"get",url:"/json_svr/exchange/?u=1"+page_rand(),data:m,xhrFields:{withCredentials:!0},success:function(r,s){var d=r,_="";if(d.records){_+="已成交:",_+="<hr/>",_+="<table id='tableRecords'>";for(u=0;u<d.records.length;u++)_+="<tr><td>",_+=u+1+".</td><td>",_+="成交价: "+num_fix(d.records[u].rate,o)+"</td>","ask"==e?(_+="<td>成交量: </td><td>"+num_fix(d.records[u].vol,l)+"&nbsp;"+get_view_symbol(n,"l")+"</td></td>",_+="<td>手续费: </td><td>"+num_fix(d.records[u].vol*d.records[u].rate*f.fee,8)+"&nbsp;"+get_view_symbol(n,"r")+"</td></tr>"):"bid"==e&&(_+="<td>成交量: </td><td>"+num_fix(d.records[u].vol,l)+"&nbsp;"+get_view_symbol(n,"l")+"</td></td>",_+="<td>手续费: </td><td>"+num_fix(d.records[u].vol*f.fee_sell,8)+"&nbsp;"+get_view_symbol(n,"l")+"</td></tr>");_+="</table>",_+="<br/>"}if(d.pending){_+="已挂单:",_+="<hr/>",_+="<table id='tablePending'>";for(var u=0;u<d.pending.length;u++)_+="<tr><td>单号: </td><td>"+d.pending[u].id+"</td></tr>",_+="<tr><td>价格: </td><td>"+num_fix(d.pending[u].rate,o)+"</td></tr>","ask"==e?(_+="<tr><td>挂单量: </td><td>"+num_fix(d.pending[u].vol,l)+"&nbsp;"+get_view_symbol(n,"l")+"</td></tr>",_+="<tr><td>手续费: </td><td>"+num_fix(d.pending[u].vol*d.pending[u].rate*f.fee,8)+"&nbsp;"+get_view_symbol(n,"r")+"</td></tr>"):"bid"==e&&(_+="<tr><td>挂单量: </td><td>"+num_fix(d.pending[u].vol,l)+"&nbsp;"+get_view_symbol(n,"l")+"</td></tr>",_+="<tr><td>手续费: </td><td>"+num_fix(d.pending[u].vol*f.fee_sell,8)+"&nbsp;"+get_view_symbol(n,"l")+"</td></tr>");_+="</table>",_+="<br/>","ask"==e?(t="<font color=green>买入</font>",get_element("balance_ask_able").innerHTML=get_element("balance_ask_able").innerHTML-d.pending[0].vol*d.pending[0].rate):(t="<font color=red>卖出</font>",get_element("balance_bid_able").innerHTML=get_element("balance_bid_able").innerHTML-d.pending[0].vol);var c=[t,num_fix(d.pending[0].rate,o),num_fix(d.pending[0].vol,l),0,"","--"];f.my_orders.push(c),f.rebuild_my_order_table()}if(d.require_fundpass){Math.random();_="<h3 style='margin-bottom:10px'>资金密码:</h3>";_+="<div style='border-bottom:1px solid #666'></div><br>",_+="<table id='tablePending' width='90%'>",_+="<tr><td class='noty-td'>输入资金密码: </td><td width='70%'><input class='inputRate' type='password' name='fundpass' id='fundpass' placeholder='请输入资金密码'></td></tr>",_+="<tr><td class='noty-td'>有效期限: </td><td width='70%'>2小时 &nbsp;&nbsp;（如有IP变化仍需输入）</td></tr>",_+="</table><tr><td><label name='tips' id='tips'>"+d.msg+"</label></td></tr>",_+="<br/>";noty({text:_,type:"confirm",layout:"center",theme:"bterNotyTheme",modal:!0,animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100},buttons:[{addClass:"btn btn-primary dp-noty-btn",text:"确定提交",onClick:function(t){var n=$("#fundpass").val();if(""==n)return $("#tips").html("<span style=color:#ff5d5d>密码不能为空，请再次输入</span>"),$("#fundpass").focus(),!1;var r=$("#captcha").val();return""==r?($("#tips").html("<span style=color:#ff5d5d>图形验证码不能为空，请再次输入</span>"),$("#captcha").focus(),!1):(f.on_request_ask_bid_confirmed(e,a,i,n,r),t.close(),!0)}},{addClass:"btn btn-danger dp-noty-btn",text:"取消",onClick:function(e){return e.close(),!1}}]})}else d.result?noty({text:_,type:"success",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100},timeout:5e3,callback:{onShow:function(){f.my_orders_num=-1}}}):(_="处理失败，请稍候再试！原因是："+d.msg,noty({text:_,type:"error",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100},timeout:5e3,callback:{onShow:function(){f.my_orders_num=-1}}}));d=null},error:function(e,t,n){noty({text:"网络错误: "+e.status+" "+e.responseText+" "+status+" "+n,type:"error",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100},timeout:5e3,callback:{onShow:function(){f.my_orders_num=-1}}})}})}},recalc_fee:function(e){if("ask"==e){get_element("ask_vol").value,get_element("ask_rate").value;var t=get_element("ask_amount").value;get_element("ask_fee").innerHTML=cut_float_zero(num_fix(t*this.fee,8)),get_element("ask_fee").innerHTML.length>11&&(get_element("ask_fee").innerHTML=get_element("ask_fee").innerHTML.substr(0,11))}else{var n=get_element("bid_vol").value;get_element("bid_rate").value,get_element("bid_amount").value;get_element("bid_fee").innerHTML=cut_float_zero(num_fix(n*this.fee_sell,8)),get_element("bid_fee").innerHTML.length>11&&(get_element("bid_fee").innerHTML=get_element("bid_fee").innerHTML.substr(0,11))}return!0},on_input_ask_vol:function(){var e=get_element("ask_amount"),t=get_element("ask_rate"),n=get_element("ask_vol"),r=num_need_fix(n.value,l);r&&(n.value=r);var a=t.value*n.value;return e.value=a,e.value<1e-4&&(e.value=0),(r=num_need_fix(e.value,s))&&(e.value=r),!0},on_input_bid_vol:function(){var e=get_element("bid_amount"),t=get_element("bid_rate"),n=get_element("bid_vol"),r=num_need_fix(n.value,l);r&&(n.value=r);var a=t.value*n.value;return e.value=a,(r=num_need_fix(a,s))&&(e.value=r),!0},on_input_ask_rate:function(){var e=get_element("ask_rate"),t=num_need_fix(e.value,o);t&&(e.value=t);var n=get_element("balance_ask_able");get_element("amount_ask_able").innerHTML=num_fix(n.innerHTML/e.value,l),f.on_input_ask_vol()},on_input_bid_rate:function(){var e=get_element("bid_rate"),t=num_need_fix(e.value,o);t&&(e.value=t),f.on_input_bid_vol()},on_input_ask_amount:function(){var e=get_element("ask_amount"),t=get_element("ask_rate"),n=get_element("ask_vol"),r=num_need_fix(e.value,s);r&&(e.value=r);var a=1e4*e.value/t.value;a<.01&&(a=0),a/=1e4,n.value=a,(r=num_need_fix(a,l))&&(n.value=r)},on_input_bid_amount:function(){var e=get_element("bid_amount"),t=get_element("bid_rate"),n=get_element("bid_vol"),r=num_need_fix(e.value,s);r&&(e.value=r);var a=1e4*e.value/t.value;return a<.01&&(a=0),a/=1e4,n.value=a,(r=num_need_fix(a,l))&&(n.value=r),!0},cancel_order:function(e,t){var n={type:"cancel",symbol:e,oid:t};$.ajax({type:"get",url:"/json_svr/exchange/?u=1"+page_rand(),data:n,xhrFields:{withCredentials:!0},success:function(e,n){var r=e;r&&r.result?(view_code="<div class='cancel_content'>撤单成功!</div>",noty({text:view_code,type:"success",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100},timeout:5e3,callback:{onShow:function(){f.my_orders_num=-1}}})):(view_code="<div class='cancel_content'>撤单失败! "+r.msg+"</div>",noty({text:view_code,type:"warning",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100},timeout:5e3,callback:{onShow:function(){f.my_orders_num=-1}}})),f.cancelled_orders.push(t),f.rebuild_my_order_table(),r=null},error:function(){noty({text:"网络错误！",type:"error",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100},timeout:5e3,callback:{onShow:function(){f.my_orders_num=-1}}})}})},update_new_rate:function(){var e=0,t=99999,n=0,r=0;if(trade_global&&trade_global.time_line)for(var a=0;a<trade_global.time_line.length;a++)tnode=trade_global.time_line[a],e=get_max(e,Number(tnode[2])),t=get_min(t,Number(tnode[3])),n=Number(tnode[4]),r+=Number(tnode[5]);var i=get_element("pb_close"),s=get_element("pb_high"),d=get_element("pb_low"),_=get_element("pb_vol");i.innerHTML=n.toFixed(o),s.innerHTML=e.toFixed(o),d.innerHTML=t.toFixed(o),_.innerHTML=r.toFixed(l)},update_best_rate:function(){get_element("rate_best_ask").innerHTML=num_fix(Number(c.best_bid_rate).toFixed(10),o),get_element("rate_best_bid").innerHTML=num_fix(Number(c.best_ask_rate).toFixed(10),o),this.update_able_amount()},update_best_rate_and_input:function(){get_element("rate_best_ask").innerHTML=num_fix(Number(c.best_bid_rate).toFixed(10),o),get_element("rate_best_bid").innerHTML=num_fix(Number(c.best_ask_rate).toFixed(10),o),get_element("ask_rate").value=get_element("rate_best_ask").innerHTML,get_element("bid_rate").value=get_element("rate_best_bid").innerHTML,this.update_able_amount()},update_able_amount:function(){var e=c.best_ask_rate,t=c.best_bid_rate,n=get_element("balance_ask_able").innerHTML/t,r=get_element("balance_bid_able").innerHTML*e,a=get_element("amount_ask_able").innerHTML;get_element("amount_bid_able").innerHTML;(a<=0||get_element("rate_best_ask").innerHTML!=num_fix(Number(c.best_bid_rate).toFixed(10),o))&&(get_element("amount_ask_able").innerHTML=num_fix(Number(n).toFixed(10),l)),(a<=0||get_element("rate_best_bid").innerHTML!=num_fix(Number(c.best_ask_rate).toFixed(10),o))&&(get_element("amount_bid_able").innerHTML=num_fix(Number(r).toFixed(10),s))},rebuild_my_order_table:function(){var e,t=0;get_symbols(n);for(orderHtml="",order=f.my_orders,cancelled=f.cancelled_orders,i=0;order.length>i;i++){e=0;for(var r=0;r<cancelled.length;r++)if(order[i][3]==cancelled[r]){e=1;break}0==e&&(void 0!==order[i][4]?ostyle=order[i][4]:ostyle="number down odd hanga",orderHtml+="<li class='"+ostyle+"'>",orderHtml+="<span class='right-align' id='tlist-date'>"+order[i][5]+"</span>",orderHtml+="<span class='right-align' id='my-type'>"+order[i][0]+"</span>",orderHtml+="<span class='right-align'>"+order[i][1]+"</span>",orderHtml+="<span class='right-align'>"+order[i][2]+"</span>",order[i][3]>0?(orderHtml+="<span class='right-align'><a href='#'  onclick=\"_page.obj.cancel_order( '',",orderHtml+=order[i][3],orderHtml+="); return false;\" style='font-size:14px;'>撤单</a></span>"):orderHtml+="<span class='right-align'>-</span>",orderHtml+="</li>",t++)}orderHtml+="",get_element("ulMyOrderList").innerHTML=orderHtml,t>0&&(get_element("divMyOrderSection").style.display="block"),f.my_orders_num=t},reload_order_data:function(){var e={type:"order_list",symbol:n};f.my_orders_num=0,$.ajax({type:"get",url:"/json_svr/query/?u=13"+page_rand(),data:e,xhrFields:{withCredentials:!0},success:function(e,r){var a,i,d=e;if(d&&d.result){if(d.balances&&2==d.balances.length&&(get_element("balance_bid_able").innerHTML=d.balances[0],get_element("balance_ask_able").innerHTML=d.balances[1]),d.debuginfo&&(get_element("debugbox").innerHTML=d.debuginfo),d.my_trade_list_table&&(get_element("my-trade-list").innerHTML=d.my_trade_list_table),d.my_funds&&(get_element("my-fund-list").innerHTML=d.my_funds,void 0===$.cookie("show_zero_funds")||"1"===$.cookie("show_zero_funds")?($("li[data-id=zero]").show(),$("#hidezero").prop("checked",!1)):($("li[data-id=zero]").hide(),$("#hidezero").prop("checked",!0))),(i=get_symbols(n))&&i.length>1&&d.order&&d.order.length>0?(f.my_orders=d.order,f.rebuild_my_order_table()):(f.my_orders.length=0,f.rebuild_my_order_table()),d.my_trade_noty&&d.my_trade_noty.length>0){var _="";for(a=0;a<d.my_trade_noty.length;a++)t=d.my_trade_noty[a],_="",_+=t.trade_type+" "+get_view_symbol(n,"l")+" 已成交:",_+="<hr/>",_+="<ul id='tableTradeNoty'><li>成交价: <span>"+num_fix(t.rate,o)+"</span><i>"+get_view_symbol(n,"r")+"</i></li><li>成交量: <span>"+num_fix(t.vol,l)+"</span><i>"+get_view_symbol(n,"l")+"</i></li><li>总计: <span>"+num_fix(t.total,s)+"</span><i>"+get_view_symbol(n,"r")+"</i></li></ul>",noty({text:_,type:"information",layout:"bottomLeft",closeWith:["button","click"],theme:"bterNotyTheme",animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:100},timeout:5e3})}}else f.my_orders_num=0;d=null},error:function(){f.my_orders_num=-1}})},recheck_order_list:function(){r&&r>0&&f.reload_order_data()},recheck:function(){f.recheck_order_list()}};return{main_rate:u,main_ask_bid_list:c,main_history_grid:m,obj:f,run:function(){$.timer(function(){f.recheck()},3e3,!0),$.timer(function(){c.recheck()},30500,!0)},createnewpoint:function(e){0==e?clearInterval(pointtimer):pointtimer=setInterval(function(){if(price_halfhour){var e=price_halfhour.length,t=parseFloat(price_halfhour[0]),n=parseFloat(price_halfhour[e-1]),r=parseFloat(price_halfhour[0]);for(i=0;i<e;i++)price_halfhour[i]>r&&(r=parseFloat(price_halfhour[i]));var a=parseFloat(price_halfhour[0]);for(i=0;i<e;i++)price_halfhour[i]<a&&(a=parseFloat(price_halfhour[i]));pricetime+=18e5,pricetime=pricetime.toString().substr(0,8),pricetime+="00000",pricetime=parseInt(pricetime);var o=1.05*r,l=.95*r;trade_global.main_chart.series[7].addPoint([pricetime,0],!1,!0),trade_global.main_chart.series[6].addPoint([pricetime,o,l],!1,!0),trade_global.main_chart.series[5].addPoint([pricetime,r],!1,!0),trade_global.main_chart.series[4].addPoint([pricetime,r],!1,!0),trade_global.main_chart.series[3].addPoint([pricetime,t],!1,!0),trade_global.main_chart.series[2].addPoint([pricetime,t,r,a,n],!1,!0),trade_global.main_chart.series[1].addPoint([pricetime,last_amount*r],!1,!0),trade_global.main_chart.series[0].addPoint([pricetime,last_amount],!1,!0),trade_global.main_chart.redraw(),price_halfhour=[],e=null,t=null,n=null,r=null,a=null}},18e5)},updatepoint:function(e){0==e?clearInterval(updateinterval):updateinterval=setInterval(function(){if(price_min){var e=price_min.length,t=parseFloat(price_min[0]),n=parseFloat(price_min[e-1]),r=parseFloat(price_min[0]);for(i=0;i<e;i++)price_min[i]>r&&(r=parseFloat(price_min[i]));var a=parseFloat(price_min[0]);for(i=0;i<e;i++)price_min[i]<a&&(a=parseFloat(price_min[i]));var o=1.05*r,l=.95*r,s=trade_global.main_chart.series[7].data.length;trade_global.main_chart.series[7].data[s-1].update([trade_global.main_chart.series[0].data[s-1].x,0]),trade_global.main_chart.series[6].data[s-1].update([trade_global.main_chart.series[0].data[s-1].x,o,l]),trade_global.main_chart.series[5].data[s-1].update([trade_global.main_chart.series[0].data[s-1].x,r]),trade_global.main_chart.series[4].data[s-1].update([trade_global.main_chart.series[0].data[s-1].x,r]),trade_global.main_chart.series[2].data[s-1].update([trade_global.main_chart.series[0].data[s-1].x,t,r,a,n]),trade_global.main_chart.series[1].data[s-1].update([trade_global.main_chart.series[0].data[s-1].x,r*last_amount]),trade_global.main_chart.series[0].data[s-1].update([trade_global.main_chart.series[0].data[s-1].x,last_amount]),price_min=[],e=null,t=null,n=null,r=null,a=null,s=null}},6e4)}}}function get_Price_Percent(e){var t=[],n=["cny","btc","eth"];for(var r in e)if("ftp_btc"!=r)for(var a in n){var i="market_"+r+"_"+n[a],o=$("#"+i+" td").eq(1).find("span");if(0!=o.length){var l=e[r].length-1-e[r].indexOf("."),s=+parseFloat(e[r]).toFixed(l);if($.isNumeric(s)&&!(s<=0)){var d=+parseFloat(get_element("currPrice").innerHTML).toFixed(l),_=o.html(),u=+parseFloat(_.substr(0,_.indexOf("<")-1)).toFixed(l);if(s!=u){if(d==s){var c="",m=get_element("top_last_rate_change").getElementsByTagName("font")[0].innerHTML;if(m.indexOf("+")>-1&&m.indexOf("-")>-1){var f=m.replace(/-/,"");c=+f.substr(1,f.length-2)}else c=+m.substr(1,m.length-2),m.indexOf("-")>-1&&(c=-c);y=c}else{var b=$("#"+i+" td").eq(2).find("font").html(),h="";if(b.indexOf("+")>-1&&b.indexOf("-")>-1){var g=b.replace(/-/,"");h=+g.substr(1,g.length-2)}else h=+b.substr(1,b.length-2),b.indexOf("-")>-1&&(h=-h);var p=parseFloat((100*u/(100+h)).toFixed(l)),y=(s-p)/p*100}if(!$.isNumeric(y))continue;t.push([s.toFixed(l),y,s-u,i])}}}}0!=t.length&&change_price_percent(t),e=null}function downColor(e){e.stop().animate({"background-color":"#c0ecda"},500).animate({"background-color":"transparent"},500,function(){e.css("background-color","")})}function upColor(e){e.stop().animate({"background-color":"#ffe8d6"},500).animate({"background-color":"transparent"},500,function(){e.css("background-color","")})}function change_price_percent(e){for(var t in e){var n,r=e[t][1].toFixed(2),a="<font color="+(e[t][1]<0?"green":"red")+" id=leftbarupdn>"+(e[t][1]<0?"":"+")+r+" %</font>",i="<span class="+(e[t][2]<0?"rate_down>":"rate_up>")+e[t][0]+(e[t][2]<0?" <i class=icon-arrow-down>↓</i></span>":" <i class=icon-arrow-up>↑</i></span>"),o=e[t][3];n=o.lastIndexOf("cny")==o.length-3?oTable:o.lastIndexOf("btc")==o.length-3?bTable:uTable;var l=$("#"+o);n.fnUpdate(a,l[0],2),n.fnUpdate(i,l[0],1),e[t][2]<0?downColor(l):upColor(l)}e=null}!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(e.jQuery)}(this,function(e,t){function n(e,t,n){var r=_[t.type]||{};return null==e?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),r.mod?(e+r.mod)%r.mod:Math.min(r.max,Math.max(0,e)))}function r(t){var n=s(),r=n._rgba=[];return t=t.toLowerCase(),u(l,function(e,a){var i,o=a.re.exec(t),l=o&&a.parse(o),s=a.space||"rgba";if(l)return i=n[s](l),n[d[s].cache]=i[d[s].cache],r=n._rgba=i._rgba,!1}),r.length?("0,0,0,0"===r.join()&&e.extend(r,i.transparent),n):i[t]}function a(e,t,n){return 6*(n=(n+1)%1)<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}var i,o=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],s=e.Color=function(t,n,r,a){return new e.Color.fn.parse(t,n,r,a)},d={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},_={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=e.each;u(d,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),s.fn=e.extend(s.prototype,{parse:function(a,o,l,_){if(a===t)return this._rgba=[null,null,null,null],this;(a.jquery||a.nodeType)&&(a=e(a).css(o),o=t);var c=this,m=e.type(a),f=this._rgba=[];return o!==t&&(a=[a,o,l,_],m="array"),"string"===m?this.parse(r(a)||i._default):"array"===m?(u(d.rgba.props,function(e,t){f[t.idx]=n(a[t.idx],t)}),this):"object"===m?(a instanceof s?u(d,function(e,t){a[t.cache]&&(c[t.cache]=a[t.cache].slice())}):u(d,function(t,r){var i=r.cache;u(r.props,function(e,t){if(!c[i]&&r.to){if("alpha"===e||null==a[e])return;c[i]=r.to(c._rgba)}c[i][t.idx]=n(a[e],t,!0)}),c[i]&&e.inArray(null,c[i].slice(0,3))<0&&(c[i][3]=1,r.from&&(c._rgba=r.from(c[i])))}),this):void 0},is:function(e){var t=s(e),n=!0,r=this;return u(d,function(e,a){var i,o=t[a.cache];return o&&(i=r[a.cache]||a.to&&a.to(r._rgba)||[],u(a.props,function(e,t){if(null!=o[t.idx])return n=o[t.idx]===i[t.idx]})),n}),n},_space:function(){var e=[],t=this;return u(d,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var r=s(e),a=r._space(),i=d[a],o=0===this.alpha()?s("transparent"):this,l=o[i.cache]||i.to(o._rgba),c=l.slice();return r=r[i.cache],u(i.props,function(e,a){var i=a.idx,o=l[i],s=r[i],d=_[a.type]||{};null!==s&&(null===o?c[i]=s:(d.mod&&(s-o>d.mod/2?o+=d.mod:o-s>d.mod/2&&(o-=d.mod)),c[i]=n((s-o)*t+o,a)))}),this[a](c)},blend:function(t){if(1===this._rgba[3])return this;var n=this._rgba.slice(),r=n.pop(),a=s(t)._rgba;return s(e.map(n,function(e,t){return(1-r)*a[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return null!=e?e:t>2?1:0});return 1===n[3]&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&t<3&&(e=Math.round(100*e)+"%"),e});return 1===n[3]&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(255*r)),"#"+e.map(n,function(e){return("0"+(e||0).toString(16)).substr(-2)}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),s.fn.parse.prototype=s.fn,d.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,r=e[0]/255,a=e[1]/255,i=e[2]/255,o=e[3],l=Math.max(r,a,i),s=Math.min(r,a,i),d=l-s,_=l+s,u=.5*_;return t=s===l?0:r===l?60*(a-i)/d+360:a===l?60*(i-r)/d+120:60*(r-a)/d+240,n=0===d?0:u<=.5?d/_:d/(2-_),[Math.round(t)%360,n,u,null==o?1:o]},d.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],i=e[3],o=r<=.5?r*(1+n):r+n-r*n,l=2*r-o;return[Math.round(255*a(l,o,t+1/3)),Math.round(255*a(l,o,t)),Math.round(255*a(l,o,t-1/3)),i]},u(d,function(r,a){var i=a.props,l=a.cache,d=a.to,_=a.from;s.fn[r]=function(r){if(d&&!this[l]&&(this[l]=d(this._rgba)),r===t)return this[l].slice();var a,o=e.type(r),c="array"===o||"object"===o?r:arguments,m=this[l].slice();return u(i,function(e,t){var r=c["object"===o?e:t.idx];null==r&&(r=m[t.idx]),m[t.idx]=n(r,t)}),_?(a=s(_(m)),a[l]=m,a):s(m)},u(i,function(t,n){s.fn[t]||(s.fn[t]=function(a){var i,l,s,d,_=e.type(a);return d="alpha"===t?this._hsla?"hsla":"rgba":r,i=this[d](),l=i[n.idx],"undefined"===_?l:("function"===_&&(a=a.call(this,l),_=e.type(a)),null==a&&n.empty?this:("string"===_&&(s=o.exec(a))&&(a=l+parseFloat(s[2])*("+"===s[1]?1:-1)),i[n.idx]=a,this[d](i)))})})}),s.hook=function(t){var n=t.split(" ");u(n,function(t,n){e.cssHooks[n]={set:function(t,a){var i;"transparent"===a||"string"===e.type(a)&&!(i=r(a))||(a=(a=s(i||a)).toRgbaString()),t.style[n]=a}},e.fx.step[n]=function(t){t.colorInit||(t.start=s(t.elem,n),t.end=s(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},s.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),e.cssHooks.borderColor={expand:function(e){var t={};return u(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},i=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}),$(function(){if("undefined"==typeof coin_type_tr_id){coin_type_tr_id=[];var e=["cny","btc","eth"];for(var t in e)for(var n=0;n<$("#marketlist_"+e[t]+" tbody").find("tr").length;n++)coin_type_tr_id.push($("#marketlist_"+e[t]+" tbody tr").eq(n).attr("id"))}});